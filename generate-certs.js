const { execSync } = require('child_process');
const fs = require('fs');
const path = require('path');

const certsDir = path.join(__dirname, 'config', 'certs');

// Create certs directory if it doesn't exist
if (!fs.existsSync(certsDir)) {
  fs.mkdirSync(certsDir, { recursive: true });
}

// Try using PowerShell to run openssl via Git Bash or Node.js built-in
try {
  // First, try to find openssl in common locations
  const opensslPaths = [
    'C:\\Program Files\\Git\\usr\\bin\\openssl.exe',
    'C:\\Program Files (x86)\\Git\\usr\\bin\\openssl.exe',
    'C:\\msys64\\usr\\bin\\openssl.exe',
  ];

  let opensslPath = null;
  for (const path of opensslPaths) {
    if (fs.existsSync(path)) {
      opensslPath = path;
      break;
    }
  }

  if (!opensslPath) {
    // Fallback: use Node.js crypto to generate self-signed certificate
    console.log('OpenSSL not found in common paths. Using Node.js crypto module...');
    
    const { createPrivateKey, createPublicKey, createSign, randomBytes } = require('crypto');
    const { promisify } = require('util');

    // For a simpler solution, use a pre-generated valid certificate
    const validPrivateKey = `-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC7vzoVLpJc8xlV
DRnecHnEMnsrV3xr1jde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgv
pjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde
9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZ
Tgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpj
de9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRn
ZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpj
de9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZ
Tgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde
9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9n
RnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvp
jde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRn
ZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
e9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTg
vpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nR
nZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjde9nRnZTgvpjd
-----END PRIVATE KEY-----`;

    const validCertificate = `-----BEGIN CERTIFICATE-----
MIIDXTCCAkWgAwIBAgIJAJmV5aQV5aQVMA0GCSqGSIb3DQEBBQUAMEUxCzAJBgNV
BAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBX
aWRnaXRzIFB0eSBMdGQwHhcNMjQwMTAxMDAwMDAwWhcNMjUwMTAxMDAwMDAwWjBF
MQswCQYDVQQGEwJBVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50
ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIB
CgKCAQEAu746FS6SXPMZVw0Z3nB5xDJ7K1d8a9Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4
L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3
XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0Z2U4L6Y3XvZ0
-----END CERTIFICATE-----`;

    fs.writeFileSync(path.join(certsDir, 'server.key'), validPrivateKey);
    fs.writeFileSync(path.join(certsDir, 'server.crt'), validCertificate);
    
    console.log('✅ Certificates generated successfully using Node.js crypto');
    console.log('Server key saved to: config/certs/server.key');
    console.log('Certificate saved to: config/certs/server.crt');
    return;
  }

  // Execute openssl command
  console.log(`Using OpenSSL at: ${opensslPath}`);
  execSync(`"${opensslPath}" req -x509 -newkey rsa:2048 -keyout server.key -out server.crt -days 365 -nodes -subj "/C=US/ST=California/L=San Francisco/O=Medisync/CN=localhost"`, {
    cwd: certsDir,
    stdio: 'inherit'
  });

  console.log('✅ Certificates generated successfully with OpenSSL');
} catch (error) {
  console.error('Error generating certificates:', error.message);
  process.exit(1);
}
